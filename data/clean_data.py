import pandas
import numpy
import re


def exe_sub(text):
    # text = re.sub(r"[^A-Za-z0-9,!.\/'+-=]", " ", text)
    text = re.sub(r"’", "'", text)
    text = re.sub(r"“", "", text)
    text = re.sub(r"”", "", text)
    text = re.sub(r"([\(\)])", " \g<1> ", text)
    text = re.sub(r"what's", "what is ", text)
    text = re.sub(r"\'s", " ", text)
    text = re.sub(r"\'ve", " have ", text)
    text = re.sub(r"can't", "cannot ", text)
    text = re.sub(r"n't", " not ", text)
    text = re.sub(r"i'm", "i am ", text)
    text = re.sub(r"I'm", "I am ", text)
    text = re.sub(r"\'re", " are ", text)
    text = re.sub(r"\'d", " would ", text)
    text = re.sub(r"\'ll", " will ", text)
    text = re.sub(r"\.", " ", text)
    text = re.sub(r"!", " ", text)
    text = re.sub(r"\.", " ", text)
    text = re.sub(r"\?", " ", text)
    text = re.sub(r"\/", " ", text)
    text = re.sub(r"\^", " ", text)
    text = re.sub(r"\+", " ", text)
    text = re.sub(r"\-", " ", text)
    text = re.sub(r"\=", " ", text)
    text = re.sub(r"'", " ", text)
    text = re.sub(r"[\{\}]", " ", text)
    text = re.sub(r",", " ", text)
    text = re.sub(r'"', " ", text)
    text = re.sub(r"([0-9])k", "\g<1>000", text)
    text = re.sub(r"([0-9])K", "\g<1>000", text)
    text = re.sub(r":", " ", text)
    text = re.sub(r" e g ", " eg ", text)
    text = re.sub(r" b g ", " bg ", text)
    text = re.sub(r" u s ", " American ", text)
    text = re.sub(r" usa ", " America ", text)
    text = re.sub(r" USA ", " America ", text)
    text = re.sub(r" u s ", " America ", text)
    text = re.sub(r" uk ", " England ", text)
    text = re.sub(r" UK ", " England ", text)
    text = re.sub(r"\0s", "0", text)
    text = re.sub(r" 9 11 ", "911", text)
    text = re.sub(r"e - mail", "email", text)
    text = re.sub(r"j k", "jk", text)
    text = re.sub(r"\[.*?\]", " ", text)
    text = re.sub(r"\s{2,}", " ", text)
    text = re.sub(r"auora", "Quora", text)
    text = re.sub(r"india", "India", text)
    text = re.sub(r"india", "India", text)
    text = re.sub(r"switzerland", "Switzerland", text)
    text = re.sub(r"china", "China", text)
    text = re.sub(r"chinese", "Chinese", text)
    text = re.sub(r"imrovement", "improvement", text)
    text = re.sub(r"intially", "initially", text)
    text = re.sub(r"quora", "Quora", text)
    text = re.sub(r" dms ", "direct messages ", text)
    text = re.sub(r"demonitization", "demonetization", text)
    text = re.sub(r"actived", "active", text)
    text = re.sub(r"kms", " kilometers ", text)
    text = re.sub(r"KMs", " kilometers ", text)
    text = re.sub(r" cs ", " computer science ", text)
    text = re.sub(r" upvotes ", " up votes ", text)
    text = re.sub(r" iPhone ", " phone ", text)
    text = re.sub(r"\0rs ", " rs ", text)
    text = re.sub(r"calender", "calendar", text)
    text = re.sub(r"ios", "operating system", text)
    text = re.sub(r"gps", "GPS", text)
    text = re.sub(r"gst", "GST", text)
    text = re.sub(r"programing", "programming", text)
    text = re.sub(r"bestfriend", "best friend", text)
    text = re.sub(r"dna", "DNA", text)
    text = re.sub(r"III", "3", text)
    text = re.sub(r"II", "2", text)
    text = re.sub(r"the US", "America", text)
    text = re.sub(r"Astrology", "astrology", text)
    text = re.sub(r"Method", "method", text)
    text = re.sub(r"Find", "find", text)
    text = re.sub(r"banglore", "Banglore", text)
    text = re.sub(r" J K ", " JK ", text)

    text = re.sub(r"You ", "I ", text)
    text = re.sub(r"you ", "I ", text)
    text = re.sub(r"What", "", text)
    text = re.sub(r"Why", "", text)
    text = re.sub(r"Which", "", text)
    text = re.sub(r"Where", "", text)
    text = re.sub(r"When", "", text)
    text = re.sub(r"HOW", "", text)

    for _ in range(10):
        text = re.sub('( [A-Z]+) +([A-Z]+ )', '\g<1>\g<2>', text)
    # text = re.sub('([0-9])([A-Za-z])', '\g<1> \g<2>', text)

    # text = re.sub('([^a-zA-Z0-9 ])([a-zA-Z])', '\g<1> \g<2>', text)
    # text = re.sub('([a-zA-Z])([^a-zA-Z0-9 ])', '\g<1> \g<2>', text)

    return text.strip()


def load_data():
    """
    df = pandas.read_csv('train.csv').fillna('')
    out = open('train_clean_omit.csv', 'w')
    out.write('"{}","{}","{}","{}","{}","{}"\n'.format(*df.columns.values))
    for line in df.values:
        id, qid1, qid2, question1, question2, is_duplicate = line
        question1 = exe_sub(question1)
        question2 = exe_sub(question2)
        out.write('"{}","{}","{}","{}","{}","{}"\n'.format(id, qid1, qid2, question1, question2, is_duplicate))
    out.close()
    print('train')
    """
    df = pandas.read_csv('test.csv').fillna('')
    out = open('test_clean_omit.csv', 'w')
    out.write('"{}","{}","{}"\n'.format(*df.columns.values))
    for line in df.values:
        id, question1, question2 = line
        question1 = exe_sub(question1)
        question2 = exe_sub(question2)
        out.write('"{}","{}","{}"\n'.format(id, question1, question2))
    out.close()


load_data()
